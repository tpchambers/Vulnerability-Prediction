# Vulnerability-Prediction
Replication and Analysis of Bilgin's et. al., IEEE published work "Vulnerability Prediction From Source Code Using Machine Learning"


**Notes:**
Team Members:
1. Tony Alarcon
2. Theo Chambers


## Source Code
Instruction on how to run developed scripts.

Instructions:
1. Download Google Drive Folder containing scrips and datasets. (https://drive.google.com/drive/folders/1C3zO1cC6vPRxarz8KyuS00cOOIKK1EpX?usp=sharing)
2. Copy the entire folder to your Google Drive in the following path: "/content/gdrive/MyDrive"


### How To Run Evaluations on Trained Models
  - CNN: Visit https://drive.google.com/file/d/1Bp0u_lSbEkLXs0GNQ5GPc6evGP6PcIiC/view?usp=sharing in google colab and run the entire script. Note that training statements have been commented out. To train a new CNN model, simply uncomment 'history = model.fit(...)'  cells for each model
  - MLP:Similarly, visit https://drive.google.com/file/d/1BqAlpuCJNiayK0anym_yvIhERAe-dUTF/view?usp=sharing in google colab and run the entire script. Training statements have been commented, trained models have been imported. To train new MLP models, simply uncomment the 'history = model.fit(...)' cells for each model.
  - SVM: Simply download the datasets cleaned from the google drive folder entitled "Processed Datasets", and copy them into this colab folder https://colab.research.google.com/drive/1Ryl10Kedm9exsEKULQPLgdzXc-kjU-Hg which will run the models. Name the files "cwe_119_train.csv", 'cwe_120_train.csv','cwe_469_train.csv', 'cwe_476_train.csv' , and 'cwe_other_train.csv' prior to compiling.

### How To Run Source Code Embedding Scripts
 
  - Visit https://colab.research.google.com/drive/1TaPTvzdkj1RCGDG4tn6K6i-T8Yv8duwr?usp=sharing in google colab and run entire script. Note that this script runs an entire preprocessing pipeline (AST generation, convertion to m-arry tree, convertion to complete binary tree, etc.) and will take over an hour to execute in its entirety. I've commened out some statements to make it run faster. For any issue, feel free to contact me directly palarcon@nd.edu



Scripts:

1. Source Code Embedding.ipynb  https://colab.research.google.com/drive/1TaPTvzdkj1RCGDG4tn6K6i-T8Yv8duwr?usp=sharing - This script is utilized to generate source code embeddings, undersample the dataset and create 5 different datasets per vulnerability category.
2. CNN.ipynb https://drive.google.com/file/d/1Bp0u_lSbEkLXs0GNQ5GPc6evGP6PcIiC/view?usp=sharing - This script builds and trains a CNN model on the 5 CWE datasets
3. MLP.ipynb https://drive.google.com/file/d/1BqAlpuCJNiayK0anym_yvIhERAe-dUTF/view?usp=sharing This script builds and trains a MLP model on the 5 CWE datasets
4. SVM_LTSM.ipynb https://colab.research.google.com/drive/1Ryl10Kedm9exsEKULQPLgdzXc-kjU-Hg This script builds and trains an SVM model (and LTSM model) on the 5 CWE datasets. Simply download the datasets cleaned from the google drive folder entitled "Processed Datasets", and copy them into this colab folder which will run the models. Name the files "cwe_119_train.csv", 'cwe_120_train.csv','cwe_469_train.csv', 'cwe_476_train.csv' , and 'cwe_other_train.csv' prior to compiling.
